{"version":3,"sources":["services/store.ts"],"names":["getItem","setItem","Todo","Todo.constructor","Todo.setTitle","TodoStore","TodoStore.constructor","TodoStore._updateStore","TodoStore.importData","TodoStore.filterList","TodoStore.get","TodoStore.add","TodoStore.remove","TodoStore.allCompleted","TodoStore.setAllTo","TodoStore.removeCompleted","TodoStore.getRemaining","TodoStore.getCompleted","TodoStore.toggleCompletion"],"mappings":"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","file":"services/store.js","sourcesContent":["/// <reference path=\"../../typings/tsd.d.ts\" />\n\nconst STORAGE_KEY = 'angular2-todos';\n\nimport {Injectable} from 'angular2/angular2';\n\nlet storage = {\n  getItem() {\n    let data = localStorage.getItem(STORAGE_KEY) || '[]';\n    try {\n      data = JSON.parse(data);\n    } catch (e) {\n      data = [];\n    }\n    return data;\n  },\n  setItem(data: Array<Todo>) {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));\n  }\n};\n\nexport class Todo {\n  completed: Boolean;\n  editing: Boolean;\n  title: String;\n  uid: String;\n\n  constructor(title: String) {\n    this.uid = Date.now().toString();\n    this.title = title.trim();\n    this.completed = false;\n    this.editing = false;\n  }\n\n  setTitle(title: String) {\n    this.title = title.trim();\n  }\n}\n\n@Injectable()\nexport class TodoStore {\n  todos: Array<Todo>;\n  constructor(filter: String) {\n    this.todos = this.importData();\n    this.todos = this.filterList(filter);\n  }\n  _updateStore() {\n    storage.setItem(this.todos);\n  }\n  importData() {\n    let persistedTodos = storage.getItem();\n    return persistedTodos.map((todo: {title: String, completed: Boolean, uid: String}) => {\n      let ret = new Todo(todo.title);\n      ret.completed = todo.completed;\n      ret.uid = todo.uid;\n      return ret;\n    });\n  }\n  filterList(filter: String) {\n    if (filter === '/active') {\n      return this.get({completed: false});\n    } else if (filter === '/completed') {\n      return this.get({completed: true});\n    } else {\n      return this.importData();\n    }\n  }\n  get(state: {completed: Boolean}) {\n    return this.todos.filter((todo: Todo) => todo.completed === state.completed);\n  }\n  add(title: String) {\n    this.todos.push(new Todo(title));\n    this._updateStore();\n  }\n  remove(uid: String) {\n    for (let todo of this.todos) {\n      if (todo.uid === uid) {\n        this.todos.splice(this.todos.indexOf(todo), 1);\n        break;\n      }\n    }\n    this._updateStore();\n  }\n  allCompleted() {\n    return this.todos.length === this.getCompleted().length;\n  }\n  setAllTo(toggler: {checked: Boolean}) {\n    this.todos.forEach((todo: Todo) => todo.completed = toggler.checked);\n    this._updateStore();\n  }\n  removeCompleted() {\n    this.todos = this.get({completed: false});\n    this._updateStore();\n  }\n  getRemaining() {\n    return this.get({completed: false});\n  }\n  getCompleted() {\n    return this.get({completed: true});\n  }\n  toggleCompletion(uid: String) {\n    for (let todo of this.todos) {\n      if (todo.uid === uid) {\n        todo.completed = !todo.completed;\n        break;\n      }\n    }\n    this._updateStore();\n  }\n}\n"],"sourceRoot":"/source/"}